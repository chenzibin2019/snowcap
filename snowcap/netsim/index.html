<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `netsim` mod in crate `snowcap`."><meta name="keywords" content="rust, rustlang, rust-lang, netsim"><title>snowcap::netsim - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"                  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"    integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "\\(", right: "\\)", display: false},
                {left: "$", right: "$", display: false},
                {left: "\\[", right: "\\]", display: true}
            ]
        });
    });
</script>

<style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../snowcap/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><p class="location">Module netsim</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#types">Type Definitions</a></li></ul></div><p class="location"><a href="../index.html">snowcap</a></p><div id="sidebar-vars" data-name="netsim" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">snowcap</a>::<wbr><a class="mod" href="">netsim</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/snowcap/netsim/mod.rs.html#18-117" title="goto source code">[src]</a></span></h1><div class="docblock"><h1 id="netsim" class="section-header"><a href="#netsim">NetSim</a></h1>
<p>This is a library for simulating specific network topologies and configuration.</p>
<p>This library was created during the Master Thesis: &quot;Synthesizing Network-Wide Configuration
Updates&quot; by Tibor Schneider, supervised by Laurent Vanbever and Rüdiker Birkener.</p>
<h2 id="example-usage" class="section-header"><a href="#example-usage">Example usage</a></h2>
<p>The following example generates a network with two border routers <code>B0</code> and <code>B1</code>, two route
reflectors <code>R0</code> and <code>R1</code>, and two external routers <code>E0</code> and <code>E1</code>. Both routers advertise the
same prefix <code>Prefix(0)</code>, and all links have the same weight <code>1.0</code>.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">snowcap</span>::<span class="ident">netsim</span>::{<span class="ident">Network</span>, <span class="ident">Prefix</span>, <span class="ident">AsId</span>, <span class="ident">BgpSessionType</span>::<span class="kw-2">*</span>};
<span class="kw">use</span> <span class="ident">snowcap</span>::<span class="ident">netsim</span>::<span class="ident">config</span>::{<span class="ident">Config</span>, <span class="ident">ConfigExpr</span>};

<span class="kw">fn</span> <span class="ident">main</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Box</span><span class="op">&lt;</span><span class="kw">dyn</span> <span class="ident">std</span>::<span class="ident">error</span>::<span class="ident">Error</span><span class="op">&gt;</span><span class="op">&gt;</span> {

    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">t</span> <span class="op">=</span> <span class="ident">Network</span>::<span class="ident">new</span>();

    <span class="kw">let</span> <span class="ident">prefix</span> <span class="op">=</span> <span class="ident">Prefix</span>(<span class="number">0</span>);

    <span class="kw">let</span> <span class="ident">e0</span> <span class="op">=</span> <span class="ident">t</span>.<span class="ident">add_external_router</span>(<span class="string">&quot;E0&quot;</span>, <span class="ident">AsId</span>(<span class="number">1</span>));
    <span class="kw">let</span> <span class="ident">b0</span> <span class="op">=</span> <span class="ident">t</span>.<span class="ident">add_router</span>(<span class="string">&quot;B0&quot;</span>);
    <span class="kw">let</span> <span class="ident">r0</span> <span class="op">=</span> <span class="ident">t</span>.<span class="ident">add_router</span>(<span class="string">&quot;R0&quot;</span>);
    <span class="kw">let</span> <span class="ident">r1</span> <span class="op">=</span> <span class="ident">t</span>.<span class="ident">add_router</span>(<span class="string">&quot;R1&quot;</span>);
    <span class="kw">let</span> <span class="ident">b1</span> <span class="op">=</span> <span class="ident">t</span>.<span class="ident">add_router</span>(<span class="string">&quot;B1&quot;</span>);
    <span class="kw">let</span> <span class="ident">e1</span> <span class="op">=</span> <span class="ident">t</span>.<span class="ident">add_external_router</span>(<span class="string">&quot;E1&quot;</span>, <span class="ident">AsId</span>(<span class="number">1</span>));

    <span class="ident">t</span>.<span class="ident">add_link</span>(<span class="ident">e0</span>, <span class="ident">b0</span>);
    <span class="ident">t</span>.<span class="ident">add_link</span>(<span class="ident">b0</span>, <span class="ident">r0</span>);
    <span class="ident">t</span>.<span class="ident">add_link</span>(<span class="ident">r0</span>, <span class="ident">r1</span>);
    <span class="ident">t</span>.<span class="ident">add_link</span>(<span class="ident">r1</span>, <span class="ident">b1</span>);
    <span class="ident">t</span>.<span class="ident">add_link</span>(<span class="ident">b1</span>, <span class="ident">e1</span>);

    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">c</span> <span class="op">=</span> <span class="ident">Config</span>::<span class="ident">new</span>();
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">source</span>: <span class="ident">e0</span>, <span class="ident">target</span>: <span class="ident">b0</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">target</span>: <span class="ident">e0</span>, <span class="ident">source</span>: <span class="ident">b0</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">source</span>: <span class="ident">b0</span>, <span class="ident">target</span>: <span class="ident">r0</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">target</span>: <span class="ident">b0</span>, <span class="ident">source</span>: <span class="ident">r0</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">source</span>: <span class="ident">r0</span>, <span class="ident">target</span>: <span class="ident">r1</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">target</span>: <span class="ident">r0</span>, <span class="ident">source</span>: <span class="ident">r1</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">source</span>: <span class="ident">r1</span>, <span class="ident">target</span>: <span class="ident">b1</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">target</span>: <span class="ident">r1</span>, <span class="ident">source</span>: <span class="ident">b1</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">source</span>: <span class="ident">b1</span>, <span class="ident">target</span>: <span class="ident">e1</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">IgpLinkWeight</span> { <span class="ident">target</span>: <span class="ident">b1</span>, <span class="ident">source</span>: <span class="ident">e1</span>, <span class="ident">weight</span>: <span class="number">1.0</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">BgpSession</span> { <span class="ident">source</span>: <span class="ident">e0</span>, <span class="ident">target</span>: <span class="ident">b0</span>, <span class="ident">session_type</span>: <span class="ident">EBgp</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">BgpSession</span> { <span class="ident">source</span>: <span class="ident">r0</span>, <span class="ident">target</span>: <span class="ident">b0</span>, <span class="ident">session_type</span>: <span class="ident">IBgpClient</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">BgpSession</span> { <span class="ident">source</span>: <span class="ident">r0</span>, <span class="ident">target</span>: <span class="ident">r1</span>, <span class="ident">session_type</span>: <span class="ident">IBgpPeer</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">BgpSession</span> { <span class="ident">source</span>: <span class="ident">r1</span>, <span class="ident">target</span>: <span class="ident">b1</span>, <span class="ident">session_type</span>: <span class="ident">IBgpClient</span> })<span class="question-mark">?</span>;
    <span class="ident">c</span>.<span class="ident">add</span>(<span class="ident">ConfigExpr</span>::<span class="ident">BgpSession</span> { <span class="ident">source</span>: <span class="ident">e1</span>, <span class="ident">target</span>: <span class="ident">b1</span>, <span class="ident">session_type</span>: <span class="ident">EBgp</span> })<span class="question-mark">?</span>;

    <span class="ident">t</span>.<span class="ident">set_config</span>(<span class="kw-2">&amp;</span><span class="ident">c</span>)<span class="question-mark">?</span>;

    <span class="comment">// advertise the same prefix on both routers</span>
    <span class="ident">t</span>.<span class="ident">advertise_external_route</span>(<span class="ident">e0</span>, <span class="ident">prefix</span>, <span class="macro">vec</span><span class="macro">!</span>[<span class="ident">AsId</span>(<span class="number">1</span>), <span class="ident">AsId</span>(<span class="number">2</span>), <span class="ident">AsId</span>(<span class="number">3</span>)], <span class="prelude-val">None</span>, <span class="prelude-val">None</span>)<span class="question-mark">?</span>;
    <span class="ident">t</span>.<span class="ident">advertise_external_route</span>(<span class="ident">e1</span>, <span class="ident">prefix</span>, <span class="macro">vec</span><span class="macro">!</span>[<span class="ident">AsId</span>(<span class="number">1</span>), <span class="ident">AsId</span>(<span class="number">2</span>), <span class="ident">AsId</span>(<span class="number">3</span>)], <span class="prelude-val">None</span>, <span class="prelude-val">None</span>)<span class="question-mark">?</span>;

    <span class="comment">// check that all routes are correct</span>
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">t</span>.<span class="ident">get_route</span>(<span class="ident">b0</span>, <span class="ident">prefix</span>)<span class="question-mark">?</span>, <span class="macro">vec</span><span class="macro">!</span>[<span class="ident">b0</span>, <span class="ident">e0</span>]);
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">t</span>.<span class="ident">get_route</span>(<span class="ident">r0</span>, <span class="ident">prefix</span>)<span class="question-mark">?</span>, <span class="macro">vec</span><span class="macro">!</span>[<span class="ident">r0</span>, <span class="ident">b0</span>, <span class="ident">e0</span>]);
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">t</span>.<span class="ident">get_route</span>(<span class="ident">r1</span>, <span class="ident">prefix</span>)<span class="question-mark">?</span>, <span class="macro">vec</span><span class="macro">!</span>[<span class="ident">r1</span>, <span class="ident">b1</span>, <span class="ident">e1</span>]);
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">t</span>.<span class="ident">get_route</span>(<span class="ident">b1</span>, <span class="ident">prefix</span>)<span class="question-mark">?</span>, <span class="macro">vec</span><span class="macro">!</span>[<span class="ident">b1</span>, <span class="ident">e1</span>]);

    <span class="prelude-val">Ok</span>(())
}</pre></div>
<h2 id="todo" class="section-header"><a href="#todo">TODO</a></h2>
<ul>
<li>Currently, messages will magically be sent from the source to the destination. change the
network such that messages are sent over actual links, and that links with infinite weight
are not allowed to be used. Also, make the routers route the actual messages.</li>
<li>Allow links to go down.</li>
<li>MED should only be compared for the same AS</li>
</ul>
</div><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2>
<table><tr><td><code>pub use bgp::<a class="enum" href="../../snowcap/netsim/bgp/enum.BgpSessionType.html" title="enum snowcap::netsim::bgp::BgpSessionType">BgpSessionType</a>;</code></td></tr></table><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="bgp/index.html" title="snowcap::netsim::bgp mod">bgp</a></td><td class="docblock-short"><p>Module containing definitions for BGP</p>
</td></tr><tr class="module-item"><td><a class="mod" href="config/index.html" title="snowcap::netsim::config mod">config</a></td><td class="docblock-short"><p>Network Configuration</p>
</td></tr><tr class="module-item"><td><a class="mod" href="external_router/index.html" title="snowcap::netsim::external_router mod">external_router</a></td><td class="docblock-short"><p>External Router</p>
</td></tr><tr class="module-item"><td><a class="mod" href="printer/index.html" title="snowcap::netsim::printer mod">printer</a></td><td class="docblock-short"><p>Helper (printer) functions for the Network</p>
</td></tr><tr class="module-item"><td><a class="mod" href="route_map/index.html" title="snowcap::netsim::route_map mod">route_map</a></td><td class="docblock-short"><p>Route-Maps</p>
</td></tr><tr class="module-item"><td><a class="mod" href="router/index.html" title="snowcap::netsim::router mod">router</a></td><td class="docblock-short"><p>Module defining an internal router with BGP functionality.</p>
</td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.AsId.html" title="snowcap::netsim::AsId struct">AsId</a></td><td class="docblock-short"><p>AS Number</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ForwardingState.html" title="snowcap::netsim::ForwardingState struct">ForwardingState</a></td><td class="docblock-short"><p>Forwarding State</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Network.html" title="snowcap::netsim::Network struct">Network</a></td><td class="docblock-short"><p>Network struct</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Prefix.html" title="snowcap::netsim::Prefix struct">Prefix</a></td><td class="docblock-short"><p>IP Prefix (simple representation)</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.ConfigError.html" title="snowcap::netsim::ConfigError enum">ConfigError</a></td><td class="docblock-short"><p>Configuration Error</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.DeviceError.html" title="snowcap::netsim::DeviceError enum">DeviceError</a></td><td class="docblock-short"><p>Router Errors</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.NetworkDevice.html" title="snowcap::netsim::NetworkDevice enum">NetworkDevice</a></td><td class="docblock-short"><p>Network Device (similar to <code>Option</code>)</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.NetworkError.html" title="snowcap::netsim::NetworkError enum">NetworkError</a></td><td class="docblock-short"><p>Network Errors</p>
</td></tr></table><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<table><tr class="module-item"><td><a class="type" href="type.IgpNetwork.html" title="snowcap::netsim::IgpNetwork type">IgpNetwork</a></td><td class="docblock-short"><p>IGP Network graph</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.LinkWeight.html" title="snowcap::netsim::LinkWeight type">LinkWeight</a></td><td class="docblock-short"><p>Link Weight for the IGP graph</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.RouterId.html" title="snowcap::netsim::RouterId type">RouterId</a></td><td class="docblock-short"><p>Router Identification (and index into the graph)</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="snowcap"></div>
    <script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>